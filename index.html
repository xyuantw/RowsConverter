<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<style>
.conver-button {
    width: 77px;
}
</style>
<title>Rows Converter</title>
</head>
<body>
    <div class="container">
        <form>
            <div class="row mt-5">
                <div class="col-5">
                    <textarea id="inputArea" class="form-control h-100 w-100" rows="20"></textarea>
                </div>
                <div class="col-2 my-auto">
                    <div class="d-flex flex-column align-items-center">
                        <button type="button" class="btn btn-primary conver-button" onclick="convert(true)"> '>' </button>
                        <button type="button" class="btn btn-secondary conver-button mt-3" onclick="convert(false)"> > </button>
                    </div>
                </div>
                <div class="col-5">
                    <textarea id="oputArea" class="form-control h-100 w-100" rows="20"></textarea>
                </div>
            </div>
        </form>
        <div class="row">
            <input type="text" id="duplicateInput" />
            <input type="text" id="inputCount" />
            <input type="text" id="outputCount" />
        </div>
    </div>
    
    <script>
        function convert(isSingleQuotationNeeded) {
            var modifier = isSingleQuotationNeeded ? "'" : "";
            var input = document.getElementById("inputArea").value;
            if (input == null || input == "") {
                return;
            }

            var rows = input.split("\n").filter(item => item !== "");
            var duplicateCount = 0;
            var inputSize = rows.length;
            rows = rows.filter(function(item, pos) {
                var isDuplicate = rows.indexOf(item) != pos;
                if (isDuplicate) {
                    duplicateCount++;
                }
                return !isDuplicate;
            });
            var outputSize = rows.length;
            for (var i = 0; i < outputSize; i++) {
                rows[i] = modifier + rows[i] + modifier;
            }
            var output = rows.join(",\n");
            document.getElementById("oputArea").value = output;
            document.getElementById("duplicateInput").value = duplicateCount;
            document.getElementById("inputCount").value = inputSize;
            document.getElementById("outputCount").value = outputSize;
        }
    </script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>